#!/usr/bin/env ruby
# Script to monitor Avalon miners status and alert if something's wrong

lib = File.expand_path('../../lib', __FILE__)
$LOAD_PATH.unshift(lib) unless $LOAD_PATH.include?(lib)

require 'yaml'
require 'avalon'

env = ARGV[0] || 'prod'

config_file = File.expand_path('../../config/monitor.yml', __FILE__)
raise "No config file: #{config_file}" unless File.exist? config_file

config = YAML::load_file(config_file)[env]

### Monitor the nodes with 30-seconds interval
Avalon::Monitor.new(config[:monitor]).run